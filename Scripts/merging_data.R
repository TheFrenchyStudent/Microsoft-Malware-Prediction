setwd("C:/Users/vernoult/Desktop/SML/Group Project/Basetable/")

library(dplyr)
library(readr)

# Block 1
priya1 <- read_csv('half_priya_woe.csv')
priya1$X1 <- NULL
priya2 <- readRDS("Microsoft_train_mid_variables.rds")
priya2 <- priya2[,-names(priya1)]

priya <- merge(priya1, priya2, by="MachineIdentifier")
saveRDS(priya, "priya.rds")
gc()

# Block 2
james1 <- read_csv("half_james_woe.csv")
james1$X1 <- NULL
james2 <- readRDS("mydata_LE3_class.rds")

james <- merge(james1, james2, by="MachineIdentifier")
saveRDS(james, "james.rds")
gc()

# Block 3
victor <- read_csv("last28variables_woe.csv")
victor$X1 <- NULL

priya <- readRDS("priya.rds")
final_basetable1 <- merge(victor, priya, by="MachineIdentifier")
saveRDS(final_basetable1, "base_inter.rds")
gc()

# Block 4
final_basetable1 <- readRDS("base_inter.rds")
final_basetable <- merge(final_basetable1, james, by="MachineIdentifier")
saveRDS(final_basetable, "FINAL_BASETABLE.rds")


head(final_basetable)
